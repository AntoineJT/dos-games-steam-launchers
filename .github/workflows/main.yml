name: Build

on: [push, pull_request, tags]

jobs:
  build:
    runs-on: windows-latest

    steps:
      - uses: actions/checkout@v4.1.6

      - name: Build
        run: ./build.bat

      # Nightly binaries on push/pull requests
      - name: Upload binaries as zip artifact
        uses: actions/upload-artifact@v4.3.3
        if: ${{ github.ref_type == 'branch' }}
        with:
          name: Binaries @ ${{ github.sha }}
          path: "*.exe"
          if-no-files-found: error

      # Release on version tag
      - name: Create release on tag
        uses: softprops/action-gh-release@v2.0.5
        if: ${{ github.ref_type == 'tag' }}
        with:
          name: ${{ github.ref_name }} @ Old Games Steam Launchers
          fail_on_unmatched_files: true
          generate_release_notes: true
          files: "*.exe"
